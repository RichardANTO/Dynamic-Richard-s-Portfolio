<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Admin Dashboard - Edit Portfolio</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css?v=4">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        /* Define Color Palette and Fonts */
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #f39c12;
            --success-color: #27ae60;
            --danger-color: #c0392b;
            --background-light: #f4f7f9;
            --card-background: #ffffff;
            --border-color: #e0e6ed;
            --text-color: #333333;
        }

        /* GENERAL BODY & TYPOGRAPHY */
        .admin-body {
            background: var(--background-light);
            font-family: 'Poppins', sans-serif;
            color: var(--text-color);
            margin: 0;
            padding: 0;
        }

        /* HEADER */
        .admin-header {
            background: var(--primary-color);
            color: white;
            padding: 15px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            flex-wrap: wrap;
        }

        .admin-header h1 {
            font-weight: 600;
            font-size: 1.6em;
            margin: 0;
        }

        .admin-actions {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* MAIN CONTENT WRAPPER */
        .admin-content {
            max-width: 1400px;
            margin: 30px auto;
            padding: 0 20px;
        }

        /* TABS */
        .tabs {
            display: flex;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            white-space: nowrap;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
            background: var(--card-background);
            border-radius: 8px;
            padding: 5px 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            width: 100%;
            box-sizing: border-box;
        }

        .tab-button {
            flex-shrink: 0;
            padding: 15px 25px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            transition: all 0.3s;
            color: #777;
        }

        .tab-button:hover {
            color: var(--primary-color);
            background: #f0f0f0;
        }

        .tab-button.active {
            border-bottom: 3px solid var(--primary-color);
            font-weight: 600;
            color: var(--primary-color);
            background: #e9f0ff;
            border-radius: 8px 8px 0 0;
        }

        .tab-pane {
            display: none;
            padding: 20px 0;
        }

        .tab-pane.active {
            display: block;
        }

        /* FORMS & CARDS */
        .edit-form,
        .upload-form {
            background: var(--card-background);
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            width: auto;
            box-sizing: border-box;
        }

        .edit-form h3 {
            margin-top: 0;
            color: var(--primary-color);
            font-weight: 600;
            font-size: 1.3em;
        }

        .edit-form label,
        .upload-form label {
            display: block;
            margin-top: 15px;
            margin-bottom: 5px;
            font-weight: 600;
            font-size: 0.95em;
            color: #555;
        }

        .edit-form input[type="text"],
        .edit-form textarea,
        .edit-form input[type="url"],
        .edit-form input[type="file"],
        .upload-form input[type="text"],
        .upload-form textarea,
        .upload-form input[type="file"] {
            width: 100%;
            padding: 12px;
            margin-top: 0;
            margin-bottom: 15px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            box-sizing: border-box;
            transition: border-color 0.3s;
        }

        .edit-form input[type="file"],
        .upload-form input[type="file"] {
            padding: 12px 10px;
        }

        .edit-form textarea {
            resize: vertical;
        }

        /* BUTTONS */
        .btn {
            padding: 10px 20px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            white-space: nowrap;
            overflow: hidden;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            color: white;
            background: var(--primary-color);
            margin-top: 10px;
            font-weight: 500;
            transition: background 0.3s;
        }

        .btn i.fas {
            margin-right: 8px;
        }

        .btn-secondary i.fas {
            margin-left: 5px;
            margin-right: 0;
        }

        .edit-form button[type="submit"],
        .upload-form button[type="submit"] {
            width: 100%;
            margin-top: 20px;
        }

        .btn-tiny {
            padding: 5px 12px;
            font-size: 0.8rem;
            margin-top: 5px;
            width: auto !important;
        }

        .btn-logout {
            background: var(--danger-color);
            text-decoration: none;
            color: white;
        }

        .btn-logout:hover {
            background: #a53225;
        }

        /* Button Hover Styles */
        .btn:hover:has(i.fa-save),
        .btn:hover:has(i.fa-check-circle),
        .btn:hover:has(i.fa-plus-circle),
        .btn-success:hover,
        .btn:hover:is(.btn-save) {
            background: var(--success-color);
        }

        .btn:hover:has(i.fa-trash),
        .btn:hover:has(i.fa-times),
        .btn-danger:hover,
        .btn:hover:is(.btn-delete) {
            background: var(--danger-color);
        }

        .btn:hover:has(i.fa-upload),
        .btn:hover:has(i.fa-sliders-h),
        .btn:hover:has(i.fa-plus),
        .btn-warning:hover,
        .btn:hover:is(.btn-upload) {
            background: var(--secondary-color);
        }

        .btn-secondary:hover {
            background: #193671;
        }

        .btn:hover {
            background: #193671;
        }

        /* PROJECT ITEMS - IMPROVED RESPONSIVENESS */
        .project-item {
            border: 1px solid var(--border-color);
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 8px;
            background: var(--card-background);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            position: relative;
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 25px;
        }

        .project-item .edit-form,
        .project-item .project-images {
            border: 1px solid var(--border-color);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            background: var(--card-background);
            margin-bottom: 0 !important;
            width: 100%;
            box-sizing: border-box;
        }

        .delete-project-form {
            position: absolute;
            top: 15px;
            right: 15px;
            z-index: 10;
            grid-column: 2;
        }

        .project-image-list {
            margin-top: 10px;
            max-height: 200px;
            overflow-y: auto;
            padding: 5px;
            border: 1px solid #f0f0f0;
            border-radius: 4px;
        }

        .image-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 5px 0;
            padding: 5px;
            background: #f9f9f9;
            border-radius: 3px;
            width: 100%;
            box-sizing: border-box;
        }

        .image-url {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            margin-right: 10px;
        }

        .project-content-wrapper {
            display: contents;
        }

        /* CAROUSEL SPECIFIC STYLES - UPDATED */
        .carousel-card {
            border: 1px solid var(--border-color);
            padding: 25px;
            border-radius: 8px;
            background: var(--card-background);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
            margin-bottom: 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        .carousel-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            margin-bottom: 15px;
            border-radius: 6px;
            border: 1px solid var(--border-color);
        }

        .carousel-card h3 {
            border-bottom: 1px solid #f0f0f0;
            padding-bottom: 10px;
            margin-top: 0;
            margin-bottom: 15px;
            width: 100%;
            text-align: center;
        }

        .carousel-card .edit-form {
            width: 100%;
            text-align: left;
        }

        .carousel-card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
            justify-items: center;
        }

        /* Center the carousel heading */
        #carousel h2 {
            text-align: center;
            margin-bottom: 30px;
            color: var(--primary-color);
        }

        /* Form elements alignment */
        .carousel-card .edit-form label {
            text-align: left;
            display: block;
        }

        .carousel-card .edit-form input,
        .carousel-card .edit-form textarea {
            text-align: left;
        }

        /* CERTIFICATES STYLES - UPDATED */
        .certificates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
            justify-items: center;
        }

        .cert-item {
            background: var(--card-background);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            width: 100%;
            max-width: 350px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            margin-left: auto;
            margin-right: auto;
        }

        .cert-item h4 {
            color: var(--primary-color);
            font-weight: 600;
            font-size: 1.2em;
            margin-top: 0;
            margin-bottom: 10px;
            text-align: center;
            width: 100%;
        }

        .cert-item p {
            margin: 8px 0;
            text-align: center;
            width: 100%;
        }

        .cert-item .btn-tiny {
            margin-top: 15px;
            width: 100%;
        }

        /* Center certificates heading */
        #certificates h2 {
            text-align: center;
            margin-bottom: 30px;
            color: var(--primary-color);
        }

        /* Center upload form in certificates */
        #certificates .upload-form {
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        /* GENERAL & ABOUT TAB STYLES */
        .general-tab-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 25px;
            margin-top: 20px;
        }

        .update-photo-section {
            background: var(--card-background);
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--border-color);
            margin-bottom: 20px;
        }

        .update-photo-section h4 {
            margin-top: 0;
            color: var(--primary-color);
            font-weight: 600;
            font-size: 1.1em;
        }

        .update-photo-section .current-photo {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
            margin-bottom: 10px;
            object-fit: contain;
            display: block;
        }

        .bio-and-skills-forms {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .bio-and-skills-forms .edit-form {
            margin-bottom: 0;
        }

        /* GALLERY STYLES */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .gallery-photo-item {
            background: var(--card-background);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .gallery-photo-item img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        /* ---------------------------------------------------- */
        /* --- RESPONSIVENESS (Mobile/Tablet) --- */
        /* ---------------------------------------------------- */

        /* 1. Small Tablets and Large Phones in Landscape (up to 900px) */
        @media (max-width: 900px) {
            .admin-header {
                padding: 15px 20px;
            }

            .admin-header h1 {
                width: 100%;
                text-align: center;
                margin-bottom: 10px;
            }

            .admin-actions {
                width: 100%;
                justify-content: center;
            }

            /* Project-item stacking */
            .project-item {
                display: flex;
                flex-direction: column;
                gap: 15px;
                padding: 15px;
            }

            /* Delete Button Positioning (Projects Tab) */
            .delete-project-form {
                position: static;
                order: -1;
                margin-bottom: 10px;
                text-align: right;
                width: 100%;
                grid-column: 1;
            }

            /* Inner card styling (Projects Tab) */
            .project-item .edit-form {
                margin-bottom: 0;
                padding: 15px;
            }

            .project-item .project-images {
                margin-bottom: 0;
                padding: 15px;
            }

            .project-content-wrapper {
                display: flex;
                flex-direction: column;
                gap: 15px;
                width: 100%;
            }

            /* CAROUSEL MOBILE STACKING */
            .carousel-card {
                display: flex;
                flex-direction: column;
                gap: 15px;
            }

            /* CAROUSEL GRID MOBILE */
            .carousel-card-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .carousel-card {
                max-width: 100%;
                margin: 0 10px;
            }

            /* CERTIFICATES MOBILE */
            .certificates-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .cert-item {
                max-width: 100%;
                margin: 0 10px;
            }

            /* GENERAL & ABOUT MOBILE STACKING */
            .general-tab-content {
                display: flex;
                flex-direction: column;
                gap: 20px;
            }

            /* TABS FIX: Ensure tabs are clearly displayed and scrolling works */
            .tabs {
                padding: 5px 10px;
            }
        }

        /* 2. Phones in Portrait (up to 600px - primary mobile view) */
        @media (max-width: 600px) {
            .admin-content {
                padding: 0 10px;
                margin: 20px auto;
            }

            .tab-button {
                padding: 10px 15px;
                font-size: 0.9em;
            }

            /* Ensure header buttons take equal space and stay on one line */
            .admin-actions {
                flex-wrap: nowrap;
                justify-content: space-between;
            }

            /* Ensure all header buttons are styled correctly */
            .admin-actions .btn-secondary,
            .admin-actions .btn-logout {
                flex: 1;
                min-width: 0;
                margin: 0;
            }

            .admin-actions .btn-secondary {
                margin-right: 10px;
            }

            /* Tweak for Project Item inner forms on tiny screens */
            .project-item .edit-form,
            .project-item .project-images {
                padding: 10px;
            }

            /* Tweak for Carousel card on tiny screens */
            .carousel-card {
                padding: 20px 15px;
                margin: 0 5px;
            }

            .carousel-card-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .carousel-card img {
                height: 180px;
            }

            /* Certificates mobile */
            .certificates-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .cert-item {
                padding: 20px 15px;
                margin: 0 5px;
            }

            /* Gallery grid for mobile */
            .gallery-grid {
                grid-template-columns: 1fr;
            }
        }

        /* ADDITIONAL FIX FOR DESKTOP SITE MODE ON MOBILE */
        @media (max-width: 768px) {
            .project-item {
                display: flex !important;
                flex-direction: column !important;
            }

            .project-item .edit-form,
            .project-item .project-images {
                min-width: 100% !important;
                max-width: 100% !important;
            }
        }
    </style>
</head>

<body class="admin-body">
    <header class="admin-header">
        <h1>Richard's Portfolio Admin</h1>
        <div class="admin-actions">
            <a href="/" class="btn btn-secondary">View Live Site <i class="fas fa-external-link-alt"
                    style="margin-left: 5px;"></i></a>
            <form action="/logout" method="POST" style="display:inline;">
                <button type="submit" class="btn btn-logout"><i class="fas fa-sign-out-alt"></i> Logout</button>
            </form>
        </div>
    </header>

    <main class="admin-content">
        <div class="tabs">
            <button class="tab-button" data-tab="carousel"><i class="fas fa-sliders-h"></i> Carousel</button>
            <button class="tab-button" data-tab="general"><i class="fas fa-user-circle"></i> General & About</button>
            <button class="tab-button" data-tab="projects"><i class="fas fa-tasks"></i> Projects</button>
            <button class="tab-button" data-tab="certificates"><i class="fas fa-certificate"></i> Certificates</button>
            <button class="tab-button" data-tab="gallery"><i class="fas fa-images"></i> Gallery</button>
        </div>

        <div id="carousel" class="tab-pane">
            <h2>Manage Hero Carousel Slides</h2>
            <div class="carousel-card-grid">
                <% portfolioData.carousel.forEach((slide, index)=> { %>
                    <div class="carousel-card">
                        <h3>Slide <%= index + 1 %>
                        </h3>
                        <img src="<%= slide.url %>" alt="Current Slide Image">

                        <form action="/admin/update-carousel/<%= index %>" method="POST" enctype="multipart/form-data"
                            class="edit-form">

                            <label for="title_<%= index %>">Title:</label>
                            <input type="text" id="title_<%= index %>" name="title" value="<%= slide.title %>" required>

                            <label for="description_<%= index %>">Description:</label>
                            <textarea id="description_<%= index %>" name="description" rows="3"
                                required><%= slide.description %></textarea>

                            <label for="buttonText_<%= index %>">Button Text:</label>
                            <input type="text" id="buttonText_<%= index %>" name="buttonText"
                                value="<%= slide.buttonText || '' %>" required>

                            <label for="link_<%= index %>">Button Link URL:</label>
                            <input type="text" id="link_<%= index %>" name="link" value="<%= slide.link %>" required>

                            <hr style="border-top: 1px dashed var(--border-color); margin: 20px 0;">

                            <label for="image_<%= index %>">Update Image (Optional):</label>
                            <input type="file" id="image_<%= index %>" name="carouselImage" accept="image/*">

                            <button type="submit" class="btn"><i class="fas fa-save"></i> Update
                                Slide</button>
                        </form>
                    </div>
                    <% }); %>
            </div>
        </div>

        <div id="general" class="tab-pane">
            <h2>General Text & About Me Content</h2>

            <div class="edit-form">
                <h3>Update Biography, Skills, and Profile Photo</h3>
                <div class="general-tab-content">
                    <div class="bio-and-skills-forms">
                        <form action="/admin/update-text" method="POST">
                            <label for="aboutSummary">About Me Summary (index.ejs):</label>
                            <textarea id="aboutSummary" name="aboutSummary"
                                rows="5"><%= portfolioData.about.summary %></textarea>

                            <label for="aboutFull">Full Story (about.ejs):</label>
                            <textarea id="aboutFull" name="aboutFull"
                                rows="10"><%= portfolioData.about.fullStory %></textarea>

                            <label for="aboutSkills">Skills/Experience List (about.ejs):</label>
                            <p style="font-size: 0.9em; margin-top: -10px; color: #777;">Edit skills list (one item per
                                line):</p>
                            <textarea id="aboutSkills" name="aboutSkills"
                                rows="8"><%= portfolioData.about.skills.join('\n') %></textarea>

                            <button type="submit" class="btn"><i class="fas fa-check-circle"></i> Save Biography &
                                Skills Text</button>
                        </form>
                    </div>

                    <div class="update-photo-section">
                        <h4>Update Profile Photo</h4>
                        <p>Current Photo:</p>
                        <img src="<%= portfolioData.about.photoUrl %>" alt="Current Photo" class="current-photo">
                        <form action="/admin/upload-photo" method="POST" enctype="multipart/form-data">
                            <label for="profilePhoto">Choose New Photo (JPG/PNG):</label>
                            <input type="file" id="profilePhoto" name="profilePhoto" accept="image/*" required>
                            <button type="submit" class="btn"><i class="fas fa-upload"></i> Upload &
                                Replace</button>
                        </form>
                    </div>
                </div>
            </div>

            <hr style="margin-top: 30px; margin-bottom: 30px; border-top: 1px solid var(--border-color);">

            <form action="/admin/update-project-summary" method="POST" enctype="multipart/form-data" class="edit-form">
                <h3>Update Project Summary Section</h3>

                <label for="projectSummaryTitle">Section Title (e.g., "About My Project"):</label>
                <input type="text" id="projectSummaryTitle" name="title"
                    value="<%= portfolioData.projectSummary.title %>" required>

                <label for="projectSummaryPara1">First Paragraph:</label>
                <textarea id="projectSummaryPara1" name="paragraph1" rows="5"
                    required><%= portfolioData.projectSummary.paragraph1 %></textarea>

                <label for="projectSummaryPara2">Second Paragraph:</label>
                <textarea id="projectSummaryPara2" name="paragraph2" rows="5"
                    required><%= portfolioData.projectSummary.paragraph2 %></textarea>

                <label for="projectSummaryLink">Button Link (e.g., /projects):</label>
                <input type="text" id="projectSummaryLink" name="buttonLink"
                    value="<%= portfolioData.projectSummary.buttonLink %>" required>

                <div class="current-image-preview" style="margin-top: 20px;">
                    <p>Current Project Summary Image:</p>
                    <img src="<%= portfolioData.projectSummary.image %>" alt="Current Project Summary Image"
                        class="current-photo" style="max-width: 200px; height: auto;">
                </div>

                <label for="projectSummaryImage">Choose New Project Summary Image (Optional):</label>
                <input type="file" id="projectSummaryImage" name="projectSummaryImage" accept="image/*">

                <button type="submit" class="btn"><i class="fas fa-save"></i> Save Project Summary</button>
            </form>

            <hr style="margin-top: 30px; margin-bottom: 30px; border-top: 1px solid var(--border-color);">

            <div class="edit-form">
                <h3>Manage Education & Experience Entries</h3>
                <div class="carousel-card-grid">
                    <% portfolioData.education.forEach((edu, index)=> { %>
                        <div class="cert-item">
                            <h4 style="color: var(--primary-color); font-weight: 500;">
                                <%= edu.title %>
                            </h4>
                            <p style="margin-bottom: 5px;"><i class="fas fa-university"
                                    style="margin-right: 5px; color: #777;"></i> Institution: <%= edu.institution %>
                            </p>
                            <p style="margin-bottom: 15px;"><i class="fas fa-calendar-alt"
                                    style="margin-right: 5px; color: #777;"></i> Years: <%= edu.years %>
                            </p>
                            <img src="<%= edu.imageUrl %>" alt="Logo" class="current-photo"
                                style="max-width: 60px; height: auto; display: block;">

                            <form action="/admin/delete-education/<%= index %>" method="POST"
                                style="display:block; margin-top: 15px;">
                                <button type="submit" class="btn btn-danger btn-tiny"
                                    onclick="return confirm('Are you sure you want to delete this education entry?')"><i
                                        class="fas fa-trash"></i> Delete Entry</button>
                            </form>
                        </div>
                        <% }); %>
                </div>

                <h4
                    style="margin-top: 30px; border-top: 1px dashed var(--border-color); padding-top: 20px; color: var(--success-color);">
                    Add New Education Entry</h4>
                <form action="/admin/add-education" method="POST" enctype="multipart/form-data">
                    <label for="eduTitle">Title (e.g., Master's Software Engineering):</label>
                    <input type="text" id="eduTitle" name="title" required>

                    <label for="eduInstitution">Institution:</label>
                    <input type="text" id="eduInstitution" name="institution" required>

                    <label for="eduYears">Years (e.g., 2023 - Present):</label>
                    <input type="text" id="eduYears" name="years" required>

                    <label for="eduLogo">Institution Logo/Image:</label>
                    <input type="file" id="eduLogo" name="educationLogo" accept="image/*" required>

                    <button type="submit" class="btn"><i class="fas fa-plus-circle"></i> Add
                        Education</button>
                </form>
            </div>

            <hr style="margin-top: 30px; margin-bottom: 30px; border-top: 1px solid var(--border-color);">

            <form action="/admin/update-footer" method="POST" class="edit-form">
                <h3>Update Footer Information & Social Links</h3>

                <label for="footerName">Name/Title (Left Column Line 1):</label>
                <input type="text" id="footerName" name="name" value="<%= portfolioData.footerInfo.name %>" required>

                <label for="footerLine1">Line 1 (e.g., Degree Title):</label>
                <input type="text" id="footerLine1" name="line1" value="<%= portfolioData.footerInfo.line1 %>" required>

                <label for="footerLine2">Line 2 (e.g., Institution/Location):</label>
                <input type="text" id="footerLine2" name="line2" value="<%= portfolioData.footerInfo.line2 %>" required>

                <hr style="border-top: 1px dashed var(--border-color); margin: 20px 0;">

                <h4>Social/Contact Links (Center Column)</h4>
                <label for="githubLink">GitHub URL:</label>
                <input type="url" id="githubLink" name="githubLink" value="<%= portfolioData.footerInfo.githubLink %>"
                    required>

                <label for="emailLink">Email (mailto: link):</label>
                <input type="text" id="emailLink" name="emailLink" value="<%= portfolioData.footerInfo.emailLink %>"
                    required>

                <label for="phoneLink">Phone (tel: link):</label>
                <input type="text" id="phoneLink" name="phoneLink" value="<%= portfolioData.footerInfo.phoneLink %>"
                    required>

                <label for="linkedinLink">LinkedIn URL:</label>
                <input type="url" id="linkedinLink" name="linkedinLink"
                    value="<%= portfolioData.footerInfo.linkedinLink %>" required>

                <button type="submit" class="btn"><i class="fas fa-save"></i> Save Footer Info</button>
            </form>
        </div>

        <div id="projects" class="tab-pane">
            <h2>Manage Projects</h2>
            <% portfolioData.projects.forEach(project=> { %>
                <div class="project-item">
                    <form action="/admin/delete-project/<%= project.id %>" method="POST" class="delete-project-form">
                        <button type="submit" class="btn btn-danger btn-tiny"
                            onclick="return confirm('Are you sure you want to delete the entire project: <%= project.title %>? This cannot be undone.')">
                            <i class="fas fa-trash"></i> Delete Project
                        </button>
                    </form>

                    <div class="project-content-wrapper">
                        <form action="/admin/update-project/<%= project.id %>" method="POST" class="edit-form">
                            <h4 style="margin-top: 0;">Project Details: <%= project.title %>
                            </h4>
                            <label for="title_<%= project.id %>">Project Title:</label>
                            <input type="text" id="title_<%= project.id %>" name="title" value="<%= project.title %>"
                                required>

                            <label for="desc_<%= project.id %>">Description:</label>
                            <textarea id="desc_<%= project.id %>" name="description" rows="4"
                                required><%= project.description %></textarea>

                            <label for="link_<%= project.id %>">GitHub Link:</label>
                            <input type="url" id="link_<%= project.id %>" name="githubLink"
                                value="<%= project.githubLink %>" required>

                            <button type="submit" class="btn"><i class="fas fa-save"></i> Save Changes</button>
                        </form>

                        <div class="project-images">
                            <h4>Manage Images (Current: <%= project.images.length %>)</h4>
                            <div class="project-image-list">
                                <% project.images.forEach(imgUrl=> { %>
                                    <div class="image-item">
                                        <span class="image-url">
                                            <%= imgUrl %>
                                        </span>
                                        <form action="/admin/delete-project-image/<%= project.id %>" method="POST">
                                            <input type="hidden" name="imageUrl" value="<%= imgUrl %>">
                                            <button type="submit" class="btn btn-danger btn-tiny"
                                                onclick="return confirm('Delete this image?')">
                                                <i class="fas fa-times"></i>
                                            </button>
                                        </form>
                                    </div>
                                    <% }); %>
                            </div>

                            <hr style="border-top: 1px dashed var(--border-color); margin: 15px 0;">

                            <form action="/admin/upload-project-image/<%= project.id %>" method="POST"
                                enctype="multipart/form-data">
                                <label for="projImg_<%= project.id %>">Upload New Image:</label>
                                <input type="file" id="projImg_<%= project.id %>" name="projectImage" accept="image/*"
                                    required>
                                <button type="submit" class="btn"><i class="fas fa-plus"></i> Add Image</button>
                            </form>
                        </div>
                    </div>
                </div>
                <% }); %>

                    <h3 style="margin-top: 40px; color: var(--primary-color);">Add New Project</h3>
                    <form action="/admin/add-project" method="POST" class="upload-form">
                        <label for="newTitle">Title:</label>
                        <input type="text" id="newTitle" name="title" required>

                        <label for="newDesc">Description:</label>
                        <textarea id="newDesc" name="description" rows="3" required></textarea>

                        <label for="newLink">GitHub Link:</label>
                        <input type="url" id="newLink" name="githubLink" required>

                        <button type="submit" class="btn"><i class="fas fa-plus-circle"></i> Add Project</button>
                    </form>
        </div>

        <div id="certificates" class="tab-pane">
            <h2>Upload Certificates (PDF)</h2>
            <div class="carousel-card-grid">
                <% portfolioData.certificates.forEach(cert=> { %>
                    <div class="cert-item">
                        <h4 style="color: var(--primary-color);">
                            <%= cert.title %>
                        </h4>
                        <p style="color: #666; margin-top: -10px;">Issued By: <%= cert.issuer %>
                        </p>
                        <p style="margin-top: 15px;"><i class="fas fa-file-pdf"
                                style="margin-right: 5px; color: var(--danger-color);"></i> File: <a
                                href="<%= cert.pdfUrl %>" target="_blank" class="btn btn-secondary btn-tiny"
                                style="background: var(--danger-color);">View PDF</a></p>
                        <form action="/admin/delete-certificate/<%= cert.id %>" method="POST"
                            style="display:block; margin-top: 15px;">
                            <button type="submit" class="btn btn-danger btn-tiny"><i class="fas fa-trash"></i>
                                Delete</button>
                        </form>
                    </div>
                    <% }); %>
            </div>

            <h3 style="margin-top: 40px; color: var(--primary-color);">Upload New Certificate</h3>
            <form action="/admin/upload-certificate" method="POST" enctype="multipart/form-data" class="upload-form">
                <label for="certTitle">Certificate Title:</label>
                <input type="text" id="certTitle" name="title" required>
                <label for="certIssuer">Issued By:</label>
                <input type="text" id="certIssuer" name="issuer" required>
                <label for="certPDF">Choose PDF File:</label>
                <input type="file" id="certPDF" name="certificateFile" accept=".pdf" required>
                <button type="submit" class="btn"><i class="fas fa-upload"></i> Upload Certificate</button>
            </form>
        </div>

        <div id="gallery" class="tab-pane">
            <h2>Manage Gallery Photos</h2>

            <div class="gallery-grid">
                <% portfolioData.gallery.forEach(photo=> { %>
                    <div class="gallery-photo-item">
                        <img src="<%= photo.url %>" alt="<%= photo.caption %>">

                        <form action="/admin/update-gallery-caption/<%= photo.id %>" method="POST" class="caption-form">
                            <input type="text" name="caption" value="<%= photo.caption %>" placeholder="Enter Caption"
                                style="width: 100%; margin-bottom: 5px;">
                            <button type="submit" class="btn btn-tiny"><i class="fas fa-save"></i> Save
                                Caption</button>
                        </form>

                        <hr style="border-top: 1px dashed var(--border-color); margin: 10px 0;">

                        <form action="/admin/update-gallery-photo/<%= photo.id %>" method="POST"
                            enctype="multipart/form-data" style="margin-bottom: 10px;">
                            <label for="galleryReplace_<%= photo.id %>"
                                style="display: block; font-size: 0.9em; margin-bottom: 5px;">Replace Image
                                (Optional):</label>
                            <input type="file" id="galleryReplace_<%= photo.id %>" name="galleryImage" accept="image/*"
                                style="width: 100%; margin-bottom: 5px;">
                            <button type="submit" class="btn btn-tiny"><i class="fas fa-upload"></i> Replace
                                Photo</button>
                        </form>

                        <form action="/admin/delete-gallery-photo/<%= photo.id %>" method="POST"
                            style="margin-top:10px;">
                            <button type="submit" class="btn btn-danger btn-tiny"><i class="fas fa-trash"></i>
                                Delete</button>
                        </form>
                    </div>
                    <% }); %>
            </div>

            <h3 style="margin-top: 20px; color: var(--primary-color);">Upload New Gallery Photo</h3>
            <form action="/admin/upload-gallery" method="POST" enctype="multipart/form-data" class="upload-form">
                <label for="galleryImage">Choose Image File:</label>
                <input type="file" id="galleryImage" name="galleryImage" accept="image/*" required>
                <label for="galleryCaption">Caption:</label>
                <input type="text" id="galleryCaption" name="caption" required>
                <button type="submit" class="btn"><i class="fas fa-upload"></i> Upload Photo</button>
            </form>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tabs = document.querySelectorAll('.tab-button');
            const panes = document.querySelectorAll('.tab-pane');

            // Function to handle the actual tab switching
            const activateTab = (tabId) => {
                // Remove 'active' from all buttons and panes
                tabs.forEach(btn => btn.classList.remove('active'));
                panes.forEach(pane => pane.classList.remove('active'));

                // Find the button and pane for the given ID and activate them
                const targetButton = document.querySelector(`.tab-button[data-tab="${tabId}"]`);
                const targetPane = document.getElementById(tabId);

                if (targetButton && targetPane) {
                    targetButton.classList.add('active');
                    targetPane.classList.add('active');
                }
            };

            // 1. Check URL Hash on Load
            const hash = window.location.hash.substring(1);
            if (hash && document.querySelector(`.tab-button[data-tab="${hash}"]`)) {
                activateTab(hash);
            } else {
                // Default to 'general' tab if no hash is present or invalid hash
                activateTab('general');
            }

            // 2. Add Click Listeners for standard tab navigation
            tabs.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.getAttribute('data-tab');
                    activateTab(tabId);
                    // Update URL hash without causing a full page reload
                    window.history.pushState(null, null, `#${tabId}`);
                });
            });
        });
    </script>
</body>

</html>